  <!DOCTYPE html>
  <html>
    <head>
      <title>Firetime</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      
      <!-- links -->
      <link rel="icon" href="/resources/assets/coffee.png" type="image/gif" sizes="32x32">
      <link rel="stylesheet" href="/resources/css/defaults.css">
      <link rel="stylesheet" href="/resources/css/bootstrap.min.css">
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
      <link rel="stylesheet" href="landing.css">
    </head>

    <script type="text/javascript">
      let tasks_alive = [];
      let activeCount = 0;
      let inactiveCount = 0;

      // Makes a unique id string for this app by combining some random numbers with the 
      // current time. This will basically always be unique for the purposes of this 
      // application, if there are two items with the same ID then you've caused a cosmic 
      // anomaly, and the universe is just a complete lie. This is a trash sandwich.
      function makeID() {
        function trash() {
          return Math.floor((1 + Math.random()) * 0x10000);
        }
        return `${trash()}${Date.now()}${trash()}`;
      }

      function toggleTaskCreate() {
        $('#modalCreateTask').modal('toggle');
      }

      function thenDo(id) {

      }

      function makeTaskActive(id) {
        let element = document.getElementById(id);

        // Update visuals
        if(activeCount == 0)
          document.getElementById("ft-tasklist-active").innerHTML = "";
     
        document.getElementById("ft-tasklist-active").appendChild(element);
        document.getElementById("toggle-" + id).innerHTML =`
          <a href="javascript:makeTaskComplete('${id}'); ">
            <i class="fas fa-check fa-2x"></i></a>
          <a href="javascript:makeTaskInactive('${id}'); ">
            <i class="fas fa-minus fa-2x"></i></a>
        `;

        if(inactiveCount <= 1) {
          inactiveCount = 0;
          console.log("Here");
          document.getElementById("ft-tasklist-idle").innerHTML = `<h4><small class="text-muted">Nothing yet!</small></h4>`;
        }
        ++activeCount;
      }

      function makeTaskInactive(id) {
        let element = document.getElementById(id);
        
        // Update visuals
        if(inactiveCount == 0)
          document.getElementById("ft-tasklist-idle").innerHTML = "";
     
        document.getElementById("ft-tasklist-idle").appendChild(element);
        document.getElementById("toggle-" + id).innerHTML =`
          <a href="javascript:makeTaskActive('${id}');">
            <i class="fas fa-plus fa-2x"></i><i class="fas fa-plus fa-2x invisible"></i></a>
        `;


        if(activeCount <= 1) {
          activeCount = 0;
          document.getElementById("ft-tasklist-active").innerHTML = `<h4><small class="text-muted">Nothing yet!</small></h4>`;
        }
        ++inactiveCount;
      }

      // Not lovely, but could be a DOM object some other day.
      function taskToHTML(task) {
        return `<div class="ft-task-item text-left" id="${task.id}" taskactive=false>
            <div class="row"> <!-- In theory, onclick could be added to the entire div. -->
              <div class="col-xs ft-task-name" id="toggle-${"" + task.id}">
                <a href="javascript:makeTaskActive('${task.id}');">
                  <i class="fas fa-plus fa-2x"></i>
                  <i class="fas fa-plus fa-2x invisible"></i>
                </a>
              </div>
              <div class="col-sm-2 ft-task-name align-middle">
                <strong style="color: ${task.color}; ">${task.name}</strong>
              </div>
              <div class="col-sm-7 ft-task-desc align-middle">
                <p>${task.description}</p>
              </div>
              <div class="col-sm-1 ft-task-time align-middle">
                <p>${task.timeEstimated}</p>
              </div>
            </div>
          </div>
        `;
      }

      function createTask(e) {
        // Stop us from navigating by default with a form
        e.preventDefault();

        // Parse all info out of the form
        let task = {
          id: makeID(),
          name: document.getElementById("ft-name").value,
          description: document.getElementById("ft-description").value,
          timeEstimated: parseInt(document.getElementById("ft-estimated").value),
          color: document.getElementById("ft-color").value,
          timeCreated: Date.now(),
        };

        if(inactiveCount == 0)
          document.getElementById("ft-tasklist-idle").innerHTML = "";
        
        document.getElementById("ft-tasklist-idle").innerHTML += taskToHTML(task);
        
        // update variables
        tasks_alive[task.id] = task;
        ++inactiveCount;
        toggleTaskCreate();
      }

    </script>


    <body>
      <div class="container">
        <div class="ft-main-buttons">
          <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#modalCreateTask">
            Create Task
          </button>
          <button type="button" class="btn btn-lg">
            Logout
          </button>
        </div>

        <div class="ft-primary">

          <div>
            <h3>Active Tasks</h3>
            <h4><small class="text-muted">This is what you have going on now</small></h4>
            <hr/>
            <div class="ft-partial">
              <div id="ft-tasklist-active">
               
                <!-- Default if you load the page and there is nothing -->
                <h4><small class="text-muted">Nothing yet!</small><h4>

              </div>
            </div>
          </div>

          <div class="ft-tasklist">
            <h3 >Task List</h3>
            <h4><small class="text-muted">Select a task to get started!</small></h4>
            <hr/>
            <div class="ft-partial">
              <div id="ft-tasklist-idle">

                <!-- Default if you load the page and there is nothing -->
                <h4><small class="text-muted">Nothing yet!</small></h4>

              </div>
            </div>
          </div>

        </div>
      </div>


      <!-- This is the modal pop-up that happens when you say 'create task'-->
      <div class="modal fade" id="modalCreateTask" role="dialog">
      <div class="modal-dialog">
      <div class="modal-content">

        <div class="ft-form" style="padding-bottom: 20px;">
          <form onsubmit="return createTask(event)">
            <div class="form-group">
              <label for="ft-input-name">Task Name <span class="ft-asterisk">*</span></label>
              <input class="form-control" id="ft-name" aria-describedby="taskName" placeholder="Enter Task Name" required>
            </div>
            <div class="form-group">
              <label for="ft-input-description">Task Description</label>
              <input class="form-control" id="ft-description" placeholder="Enter Task Description">
              <small id="ft-help-description" class="form-text text-muted">Try keeping this short and sweet - one sentence should do!</small>
            </div>
            <div class="form-group">
              <label for="ft-input-estimated">Estimated Time in Minutes <span class="ft-asterisk">*</span></label>
              <input type="number" class="form-control" id="ft-estimated" placeholder="5, 10, 15, 30, 60, 90..." required>
              <small id="ft-help-estimated" class="form-text text-muted">Try and keep this under 4 hours! <a href="#">Need a hand estimating?</a></small>
            </div>
            <div class="form-group">
              <label for="ft-input-color">Color</label>
              <select class="form-control" id="ft-color" style="height: 100%;">
                <option>Grey</option>
                <option>Violet</option>
                <option>Indigo</option>
                <option>Blue</option>
                <option>Green</option>
                <option>Yellow</option>
                <option>Orange</option>
                <option>Red</option>
              </select>
            </div>
              <small id="ft-required-field" class="form-text text-muted font-italic"><span class="ft-asterisk">*</span> Indicates required field</small>
            <br/>
            <div class="text-right">
              <button type="submit" class="btn btn-info">Submit</button> 
              <button type="button" class="btn" onclick="toggleTaskCreate();">Cancel</button>
            </div>
          </form>
        </div>

      </div>
      </div>  
      </div>

    </body>

  </html>